<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no"/>
    <title>天下VPN</title>
    <link rel="stylesheet" type="text/css" href="../static/css/normalize.css"/><!--CSS RESET-->
    <!--Material Design Iconic Font-->
    <link rel="stylesheet" href="../static/material-design/css/material-design-iconic-font.css"/>
    <!--jSide Menu CSS-->
    <link rel="stylesheet" href="../static/css/jside-menu.css"/>
    <link rel="stylesheet" href="../static/css/htmleaf-demo.css"/>
    <!--jSide Skins-->
    <link rel="stylesheet" href="../static/css/jside-skins.css"/>
    <link rel="stylesheet" href="../static/css/demo-only.css"/>

</head>
<style>
    .tc h3 {
        color: black;
        text-align: center;
        padding-top: 5px;
        line-height: 10px;
    }

    .tc h2 {
        color: orangered;
        text-align: center;
        line-height: 20px;
    }

    h4 {
        color: #595757;
        margin-left: 5px;
    }

</style>
<body>
<menu class="menubar">
    <menuitem>
        <button class="menu-trigger"></button>
    </menuitem>

    <menuitem class="logo" title="Your Logo Goes Here">
        <h6>订单列表</h6>
    </menuitem>
</menu>


<div class="menu-head">
	   <span class="layer">
	<div class="col">
	  <div class="row for-pic">
	   <div class="profile-pic">
	   <img src="../static/image/asif-mughal.jpg" alt="Asif Mughal"/>
	         </div>
	  </div>
	         <div class="row for-name">
	   <h3 title="User Name"> 售后问题反馈 </h3>
	        <span class="tagline"> kangoShy@gmail.com </span>
	          </div>
	         </div> <!--//col-->
	  </span>
</div> <!--//menu-head-->

<nav class="menu-container">

    <ul class="menu-items">

        <li><span class="item-icon"> <i class="zmdi zmdi-tv"></i> </span> <a href="/toIndex">
            首页 </a></li>

        <li><span class="item-icon"><i class="zmdi zmdi-android"></i></span> <a href="/androidCourse">
            Android 使用教程 </a></li>

        <li><span class="item-icon"> <i class="zmdi zmdi-apple"></i> </span> <a href="/iosCourse">
            IOS 使用教程 </a></li>

        <li class="has-sub"><span class="item-icon"> <i class="zmdi zmdi-windows"></i> </span>
            <a href="/windowsCourse">Windows 使用教程</a></li>

        <li class="has-sub"><span class="item-icon"> <i class="zmdi zmdi-devices"></i> </span>
            <a href="/macCourse">Mac 使用教程</a></li>


        <li><span class="item-icon"> <i class="zmdi zmdi-keyboard"></i> </span> <a href="#1">
            操作指南 </a></li>

        <li><span class="item-icon"> <i class="zmdi zmdi-dock"></i> </span> <a href="/myOrder">
            我的订单 </a></li>


        <li><span class="item-icon"> <i class="zmdi zmdi-mouse"></i> </span> <a href="/customerService">
            联系客服 </a></li>

        <li><span class="item-icon"> <i class="zmdi zmdi-dock"></i> </span> <a href="/logout">
            退出登录 </a></li>

    </ul>


</nav>
<div class="dim-overlay"></div>

<!--End jSide Menu-->
<!--Introduction and Demo Only -->
<br>
<header class="intro">
    <span id="combo"></span>
    <!--<h1>jquery滑动侧边栏插件jSide</h1>
    <div class="htmleaf-links">
      <a class="htmleaf-icon icon-htmleaf-home-outline" href="http://www.htmleaf.com/" title="jQuery之家" target="_blank"><span> jQuery之家</span></a>
      <a class="htmleaf-icon icon-htmleaf-arrow-forward-outline" href="http://www.htmleaf.com/jQuery/Menu-Navigation/201810195376.html" title="返回下载页" target="_blank"><span> 返回下载页</span></a>
  </div>
    <p>
     jSide Menu is a well designed, simple and clean side navigation menu with dropdowns.
       <br />
       <br />
<b> Written in:</b><i> HTML, CSS, JS</i><br>
        <b> Frameworks: </b> <i>  jQuery 3.3.1 &amp; Material-Design-Iconic-Font 2.0  </i>
    </p>-->
</header>

<br/>

<main>
    <article>
        <input type="text" id="input"  style="width: 70%;border-radius: 0;outline: none;line-height: 30px;border-left: none; border-top: none;border-right: none;" placeholder="输入套餐名或订单号进行查询" >
        <input type="button" value="查 询" style="width: 28%;border-radius: 0;outline: none;background-color: dodgerblue;color: white;border: none;line-height: 35px" onclick="findByKeyWord()"/>
    </article>
</main>

<div id="myOrders"></div>

<script src="../static/js/jquery-1.11.0.min.js" type="text/javascript"></script>
<script src="../static/js/jquery.jside.menu.js"></script>
<script src="../static/js/demo-only.js"></script>
<script>
    $(document).ready(function () {

        $(".menu-container").jSideMenu({
            jSidePosition: "position-left", //possible options position-left or position-right

            jSideSticky: true, // menubar will be fixed on top, false to set static

            jSideSkin: "default-skin", // to apply custom skin, just put its name in this string
        });
    });

    window.onload=function(){
        getMyOrderList(0,'',6);
    };

    function findByKeyWord(){
        let key = document.getElementById("input").value;
        getMyOrderList(1, key, 6);
    }

    let i = 0;
    let c = "";
    $(window).scroll(
        function() {
            var scrollTop = $(this).scrollTop();
            var scrollHeight = $(document).height();
            var windowHeight = $(this).height();
            if (scrollTop + windowHeight === scrollHeight) {
                i = i + 6;
                if (c != "d"){
                    getMyOrderList(1,"", i + 6); //每次加载5条
                }
            }
        }
    );

    function getMyOrderList(flag,key,size) {
        $.ajax({
            url:'/vpn/getMyOrderList',
            data:{'key' : key, 'pageSize': size},
            type:'GET',
            success:function(res) {
                if (flag === 1){
                    $("#myOrders").empty();
                }
                let data = res.data;
                let x = "";
                if (data != null && data.length > 0) {
                    for (let i = 0; i < data.length; i++) {
                        let start = "<main><article>"
                        let x1 =  "<h3>" + data[i].comboName + "</h3><h4>" + "订单编号：" + data[i].orderId + "</h4>";
                        let x2 = "";
                        let x4 = "";
                        if (data[i].orderStatus === "待付款") {
                            x2 = "<h4>付款方式：" + "--" + "</h4><h4>" + "应付金额：" + data[i].price + "</h4>";
                            x4 = "<h4>订单状态：<span style='color: cornflowerblue'>" + data[i].orderStatus + "</span></h4>";
                        }
                        else if (data[i].orderStatus === "已付款") {
                            x2 = "<h4>付款方式：" + data[i].pay + "</h4><h4>" + "付款金额：" + data[i].price + "</h4>";
                            x4 = "<h4>订单状态：<span style='color: mediumseagreen'>" + data[i].orderStatus + "</span></h4>";
                        }
                        else if (data[i].orderStatus === "已超时" || data[i].orderStatus === "已关闭"){
                            x2 = "<h4>付款方式：" + "--" + "</h4><h4>" + "应付金额：" + data[i].price + "</h4>";
                            x4 = "<h4>订单状态：<span style='color: red'>" + data[i].orderStatus + "</span></h4>";
                        }
                        let x3 = "<h4>套餐类型：" + data[i].comboType + "</h4>";
                        let x5 = "<h4>下单时间：" + data[i].createTime + "</h4>";
                        let end = "</article></main>";
                        x += start + x1 + x2 + x3 + x4 + x5 + end;
                    }
                    if (i >= data.length) {
                        c = "d";
                        x += "<h4 style='text-align: center'>别划了，已经到底啦~</h4>";
                    }
                }else{
                    let error = "<main><article><h4 style='text-align: center'>暂无数据</h4></article></main>";
                    $("#myOrders").html(error);
                    return;
                }
                $("#myOrders").html(x);
            },
            error:function() {
                let error = "<main><article><h4 style='text-align: center'>暂无数据</h4></article></main>";
                $("#myOrders").html(error);
            }
        })
    }

</script>
</body>
</html>